---
title: 卸载腾讯云云服务器安全监控组件云镜
createTime: 2025/01/01 00:00:00
permalink: /blog/dc4a4kik/
tags:
  - 腾讯云
---
>原帖: https://blog.kdyzm.cn/post/20

腾讯云的服务器会自动安装云监控、云镜等安全服务，方便在控制台查看产品运行状态等

可以看一下服务器的定时任务：

```bash
$ crontab -l

*/1 * * * * /usr/local/qcloud/stargate/admin/start.sh > /dev/null 2>&1 &

0 0 * * * /usr/local/qcloud/YunJing/YDCrontab.sh > /dev/null 2>&1 &
```

从来不看腾讯云的云监控控制台，要这东西有何用，卸载

云监控 Linux 安装目录是`/usr/local/qcloud/stargate`和`/usr/local/qcloud/monitor`

还有一个[主机安全](https://cloud.tencent.com/product/hs?from=10680)，也就是所谓的云镜，新开服务器不取消勾选都会默认安装

云镜 Linux 安装目录是`/usr/local/qcloud/YunJing`

统统卸载！！！

直接在腾讯[云服务器](https://cloud.tencent.com/product/cvm?from=10680)上运行以下代码

```bash
/usr/local/qcloud/stargate/admin/uninstall.sh
/usr/local/qcloud/YunJing/uninst.sh
/usr/local/qcloud/monitor/barad/admin/uninstall.sh
```

这些都是腾讯云自带的卸载脚本，如果你不想用也可以使用打包好的 shell

```bash
wget -qO- https://raw.githubusercontent.com/littleplus/TencentAgentRemove/master/remove.sh | bash
```

此脚本卸载完腾讯云的监控，但是腾讯云文件夹并不是只有监控，为了保险起见，脚本不会`rm -rf /usr/local/qcloud`，不作死就不会死

卸载完以后可以通过如下命令来查看是否卸载干净

```bash
ps -A | grep agent
```

如无任何输出，则已卸载干净，如果有输出，请检查是否你自己的程序

如果你想用的话可以具体了解一下腾讯云的服务，[云监控](https://qq52o.me/go/aHR0cHM6Ly9jbG91ZC50ZW5jZW50LmNvbS9kb2N1bWVudC9wcm9kdWN0LzI0OC8xMzQ2Ng==)，[主机安全(云镜)](https://qq52o.me/go/aHR0cHM6Ly9jbG91ZC50ZW5jZW50LmNvbS9kb2N1bWVudC9wcm9kdWN0LzI5Ng==)

转载自：<https://cloud.tencent.com/developer/article/1381482>

***

2021年初，腾讯云出了一个自动化助手客户端,随着安装系统一起启动的一个软件，需要也将其卸载掉才行，使用

```bash
ps -A | grep agent
```

命令可以看到一个agent，但是杀不死进程，杀死之后会自动重启，卸载自动化助手客户端的方法可以参考安装方法：<https://cloud.tencent.com/document/product/1340/50821>

下载<https://tat-gz-1258344699.cos.ap-guangzhou.myqcloud.com/tat_agent_linux_x86_64.zip>，解压之后运行uninstall.sh脚本即可。

***

mmp腾讯又出了新的安全组件了，又该更新脚本，使用以下脚本彻底卸载

```bash
#!/bin/bash 
#fuck tx process 
rm -rf /usr/local/sa 
rm -rf /usr/local/agenttools 
rm -rf /usr/local/qcloud 
process=(sap100 secu-tcs-agent sgagent64 barad_agent agent agentPlugInD pvdriver ) 
for i in ${process[@]} 
do
for A in $(ps aux |grep $i |grep -v grep |awk '{print $2}') 
do
kill -9 $A 
done 
done 
chkconfig --level 35 postfix off 
service postfix stop 
echo ''>/var/spool/cron/root 
echo '#!/bin/bash' >/etc/rc.local
```
